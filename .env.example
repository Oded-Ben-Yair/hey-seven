# ============================================================
# Hey Seven Property Q&A â€” Environment Configuration
# ============================================================
# Copy this file to .env and fill in real values.
# All variables have sensible defaults except GOOGLE_API_KEY.
# 56 settings across 11 categories. See src/config.py for details.
# ============================================================

# --- Google AI (REQUIRED) --------------------------------
# Gemini API key from https://aistudio.google.com/apikey
GOOGLE_API_KEY=

# --- Property Configuration ------------------------------
PROPERTY_NAME=Mohegan Sun
PROPERTY_DATA_PATH=data/mohegan_sun.json
PROPERTY_WEBSITE=mohegansun.com
PROPERTY_PHONE=1-888-226-7711             # Property contact phone for fallback messages
PROPERTY_STATE=Connecticut                # Jurisdiction for age/gaming regulations

# --- LLM Tuning -----------------------------------------
MODEL_NAME=gemini-2.5-flash           # gemini-2.5-pro for complex reasoning
MODEL_TEMPERATURE=0.3                 # 0.0-1.0; lower = more deterministic
MODEL_TIMEOUT=30                      # Seconds before LLM call times out
MODEL_MAX_RETRIES=2                   # Retry count on transient LLM errors
MODEL_MAX_OUTPUT_TOKENS=2048          # Max tokens per response
WHISPER_LLM_TEMPERATURE=0.2           # Lower temperature for deterministic whisper planning

# --- Embeddings -----------------------------------------
EMBEDDING_MODEL=gemini-embedding-001

# --- RAG Pipeline ----------------------------------------
CHROMA_PERSIST_DIR=data/chroma        # Local ChromaDB storage path
RAG_TOP_K=5                           # Number of chunks to retrieve
RAG_CHUNK_SIZE=800                    # Characters per chunk
RAG_CHUNK_OVERLAP=120                 # Overlap between adjacent chunks (~15% of chunk size)
RAG_MIN_RELEVANCE_SCORE=0.3           # Minimum relevance score (0-1, higher = more relevant)

# --- API Server ------------------------------------------
API_KEY=                                   # When set, protects /chat /graph /property /feedback with X-API-Key header
ALLOWED_ORIGINS=["http://localhost:8080"]   # CORS origins (JSON list)
RATE_LIMIT_CHAT=20                    # Max requests per minute per IP on /chat and /feedback
RATE_LIMIT_MAX_CLIENTS=10000          # Max tracked client IPs (memory guard)
# TRUSTED_PROXIES=                    # JSON list of CIDRs/IPs for X-Forwarded-For trust. None (default) = never trust XFF.
SSE_TIMEOUT_SECONDS=60                # SSE stream timeout
MAX_REQUEST_BODY_SIZE=65536           # Max request body in bytes (64 KB)

# --- Agent ------------------------------------------------
MAX_MESSAGE_LIMIT=40                  # Max total messages (human + AI) before forcing conversation end
MAX_HISTORY_MESSAGES=20               # Sliding window: only last N messages sent to LLM
ENABLE_HITL_INTERRUPT=false           # When true, pauses before generate node for human-in-the-loop review
GRAPH_RECURSION_LIMIT=10              # LangGraph recursion limit (validate->retry loop bound)
CB_FAILURE_THRESHOLD=5                # Circuit breaker: consecutive failures to open
CB_COOLDOWN_SECONDS=60                # Circuit breaker: seconds before half-open probe
COMP_COMPLETENESS_THRESHOLD=0.60      # Minimum profile completeness for comp agent offers
SEMANTIC_INJECTION_ENABLED=true       # Enable/disable semantic injection classifier (LLM second layer)
SEMANTIC_INJECTION_THRESHOLD=0.8      # Confidence threshold for semantic injection classifier
# SEMANTIC_INJECTION_MODEL=           # Override model for semantic classifier (empty = use default)

# --- Vector DB -------------------------------------------
VECTOR_DB=chroma                      # "chroma" (local dev) or "firestore" (GCP prod)
# FIRESTORE_PROJECT=                  # GCP project ID for Firestore checkpointer (required when VECTOR_DB=firestore)
FIRESTORE_COLLECTION=knowledge_base   # Firestore collection name

# --- Multi-tenant ----------------------------------------
CASINO_ID=mohegan_sun                 # Multi-tenant casino identifier (used for feature flags, config isolation)

# --- CMS -------------------------------------------------
# CMS_WEBHOOK_SECRET=                 # HMAC-SHA256 secret for Google Sheets webhook (REQUIRED in production)
# GOOGLE_SHEETS_ID=                   # Google Sheets spreadsheet ID for CMS content

# --- SMS -------------------------------------------------
SMS_ENABLED=false                     # Enable SMS channel support
# CONSENT_HMAC_SECRET=               # HMAC key for consent hash chain (REQUIRED when SMS_ENABLED=true; must not be default)
PERSONA_MAX_CHARS=0                   # 0 = unlimited (web), 160 = SMS segment limit
# TELNYX_API_KEY=                     # Telnyx API key for SMS sending
# TELNYX_MESSAGING_PROFILE_ID=       # Telnyx messaging profile ID
# TELNYX_PUBLIC_KEY=                  # Telnyx Ed25519 public key for webhook signature verification
QUIET_HOURS_START=21                  # SMS quiet hours start (9 PM local)
QUIET_HOURS_END=8                     # SMS quiet hours end (8 AM local)
# SMS_FROM_NUMBER=                    # SMS sender number (E.164 format, e.g. +18605551234)

# --- Observability ---------------------------------------
LOG_LEVEL=INFO                        # DEBUG | INFO | WARNING | ERROR
ENVIRONMENT=development               # development | staging | production
VERSION=1.0.0                         # Application version (reported by /health endpoint)

# --- LangFuse (Primary Observability) -------------------
# LANGFUSE_PUBLIC_KEY=               # LangFuse observability public key
# LANGFUSE_SECRET_KEY=               # LangFuse observability secret key
# LANGFUSE_HOST=https://cloud.langfuse.com  # LangFuse server URL

# --- LangSmith (Optional LangChain Tracing) -------------
# LANGCHAIN_TRACING_V2=true
# LANGCHAIN_API_KEY=
# LANGCHAIN_PROJECT=hey-seven
